import greenfoot.*;

public class LevelHandler  
{
    private int currentLevel = 0;
    
    private int[][][] _levelData = {

        { // world 0
            { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,2,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
            { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
        },
        
        { // world 1
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,9},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,0,1,0,0,0,0,0,1,0,0,1},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,1},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,1},
            {0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,1,1},
            {0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,1,0,1,1},
            {1,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,1,1},
            {1,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,1,0,1,1},
            {1,2,0,0,0,0,0,4,0,0,0,0,0,1,1,1,4,4,4,4,1,0,0,5,0,0,0,0,1,1},
            {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
        },

        { //world 2
            { 0,0,0,0,0,0,4,4,1,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,0,1,0,0,6},
            { 0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            { 0,0,1,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0},
            { 0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,4,4,4,4,4,4,4,4,4,4,4},
            { 0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1},
            { 0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,5,5,5,5,5,5,5,5,5,5,0,1},
            { 0,2,0,1,0,4,4,4,4,4,4,4,4,4,4,4,4,1,7,7,7,7,7,7,7,7,7,7,9,1},
            { 1,1,1,1,4,1,1,1,1,1,1,1,1,1,1,1,1,1,8,8,8,8,8,8,8,8,8,8,1,1},
        },

        { //world 3
            {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,},
            {1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,},
            {1,2,0,0,0,0,0,1,0,0,0,0,0,0,1,},
            {1,1,1,1,1,1,0,1,0,1,0,0,1,0,1,},
            {1,0,0,0,0,0,0,1,0,0,0,0,1,0,1,},
            {1,0,0,0,0,0,0,1,2,0,0,0,1,6,1,},
            {1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,},
            {1,5,7,5,5,7,5,5,7,5,5,7,5,9,1,},
            {1,1,8,1,1,8,1,1,8,1,1,8,1,1,1,},
        },
        
        { //world 4
            { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
            { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            { 1,0,0,0,0,0,0,0,0,0,0,0,0,1,11,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            { 1,0,1,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,1,0,1},
            { 1,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            { 1,0,0,0,0,3,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,1},
            { 1,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,1},
            { 1,0,0,1,1,5,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1},
            { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
        },

    };
    
    private PlatformWorld _world;
    
    public LevelHandler(PlatformWorld world)
    {
        _world = world;
    }
    
    public int[][] getLevelData()
    {
        return _levelData[currentLevel];
    }
    
    public void advanceLevel()
    {
        currentLevel += 1;
        recreateLevel();
    }
    
    public void handleClick()
    {
        int x = Greenfoot.getMouseInfo().getX() - _world.getScrollHandler().getScrollX();
        int y = Greenfoot.getMouseInfo().getY() - _world.getScrollHandler().getScrollY();

        int column = x/50;
        int row = y/50;

        int currentValue = getLevelData()[row][column];
        int newValue = currentValue + 1;
        
        if(newValue > 11)
        {
            newValue = 0;
        }

        getLevelData()[row][column] = newValue;
        recreateLevel();
    }
    
    public void recreateLevel()
    {
        _world.removeObjects(_world.getObjects(Actor.class));
        int[][] data = getLevelData();
        for (int y = 0 ; y < data.length; y++) {
            for (int x = 0 ; x < data[y].length; x++) {
                int blocktype = data[y] [x];
                Actor thisBlock = null;
                if (blocktype == 1 ) {
                    thisBlock = new Brick();
                }
                if (blocktype == 2 ) {
                    thisBlock = new HumanPlayer(50 * x + 25, 50* y + 25);
                }
                if (blocktype == 5 ) {
                    thisBlock = new ComputerPlayer(50 * x + 25, 50* y + 25);
                }
                if (blocktype == 3 ) {
                    thisBlock = new Spring();
                }
                if (blocktype == 4) {
                    thisBlock = new Spike();
                }
                if (blocktype == 6) {
                    thisBlock = new Plate();
                }
                if (blocktype == 7) {
                    thisBlock = new TrapSpike();
                }
                if (blocktype == 8) {
                    thisBlock = new TrapBrick();
                }
                if (blocktype == 9) {
                    thisBlock = new Flag();
                }
                if (blocktype == 10) {
                    thisBlock = new PowerUp();
                }
                if (blocktype == 11) {
                    thisBlock = new BeeBoss();
                }
                if (blocktype == 12) {
                    thisBlock = new Turret();
                }
                
                if (thisBlock != null) {
                    _world.addObject(thisBlock, 50 * x + 25,50 * y + 25);
                }
            }
        }
    }
    
    public String getLevelAsString()
    {
        String board = "";
        int[][] data = getLevelData();

        board += "{";
        board += "\n";    

        for (int y = 0 ; y < data.length; y++) {
            board += "    {";

            for (int x = 0 ; x < data[y].length; x++)
            {
                board += data[y][x] + ",";
            }
            board += "},";

            board += "\n";

        }
        board += "},";
        return board;
    }
}
